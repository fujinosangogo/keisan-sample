<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>たしざんプリント</title>

<style>
@page {
  size: A4;
  margin: 15mm;
}

body {
  font-family: sans-serif;
  text-align: center;
}

.controls {
  margin-bottom: 15px;
}

input, select, button {
  font-size: 16px;
  padding: 5px;
  margin: 5px;
}

#name {
  margin: 15px 0;
  font-size: 18px;
}

#problems {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px 40px;
  font-size: 26px;
  margin-top: 10px;
}

.problem {
  padding: 4px 0;
}

@media print {
  .controls {
    display: none;
  }
}
</style>
</head>
<body>

<h1>たしざんプリント</h1>

<div class="controls">
  桁数：
  <input type="number" id="minDigits" value="1" min="1" max="6"> 〜
  <input type="number" id="maxDigits" value="1" min="1" max="6"> 桁

  繰り上がり：
  <select id="carry">
    <option value="no">なし</option>
    <option value="yes">あり</option>
  </select>

  問題数：
  <input type="number" id="count" value="30" min="1" max="200">

  <button onclick="generate()">生成</button>
  <button onclick="window.print()">印刷</button>
</div>

<div id="name">
  なまえ：____________________
</div>

<div id="problems"></div>

<script>
function randomDigits(minD, maxD) {
  return Math.floor(Math.random() * (maxD - minD + 1)) + minD;
}

function randomNumber(digits) {
  let min = Math.pow(10, digits - 1);
  let max = Math.pow(10, digits) - 1;
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function generate() {
  const minDigits = parseInt(document.getElementById("minDigits").value);
  const maxDigits = parseInt(document.getElementById("maxDigits").value);
  const carry = document.getElementById("carry").value;
  const count = parseInt(document.getElementById("count").value);
  const container = document.getElementById("problems");

  if (minDigits > maxDigits) {
    alert("最小桁数は最大桁数以下にしてください");
    return;
  }

  container.innerHTML = "";

  for (let i = 0; i < count; i++) {

    let digits = randomDigits(minDigits, maxDigits);
    let a, b;

    if (carry === "no") {

      while (true) {
        a = randomNumber(digits);
        b = randomNumber(digits);

        let ok = true;
        let aStr = a.toString().padStart(digits, "0");
        let bStr = b.toString().padStart(digits, "0");

        for (let j = 0; j < digits; j++) {
          if (parseInt(aStr[j]) + parseInt(bStr[j]) >= 10) {
            ok = false;
            break;
          }
        }

        if (ok) break;
      }

    } else {
      a = randomNumber(digits);
      b = randomNumber(digits);
    }

    const div = document.createElement("div");
    div.className = "problem";
    div.textContent = `${a} ＋ ${b} ＝ ＿＿`;
    container.appendChild(div);
  }
}

generate();
</script>

</body>
</html>
